<div class="flex justify-center items-center min-h-screen bg-gray-100 p-4">
  <p-card header="Sélectionner" styleClass="shadow-lg w-full md:w-1/2 lg:w-1/3">
    <ng-template pTemplate="content">
      <form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
        <p-treeselect
          class="w-full"
          [options]="treeData"
          formControlName="selectedNode"
          placeholder="Sélectionnez une option"
          selectionMode="single"
          display="chip"
          [showClear]="true"
          emptyMessage="Aucune option disponible"
          [loading]="isLoading"
          (onNodeSelect)="onNodeSelect($event)"
          [panelStyle]="{ 'max-height': '300px' }"
          scrollHeight="300px"
        >
          <ng-template let-node pTemplate="option">
            <div class="flex items-center gap-2">
              <i [class]="node.icon" class="mr-2"></i>
              <span>{{ node.label }}</span>
            </div>
          </ng-template>
          
          <ng-template let-node pTemplate="selectedicon">
            <i [class]="node.icon" class="mr-2"></i>
          </ng-template>
        </p-treeselect>

        <div *ngIf="selectedNode" class="p-3 bg-gray-50 rounded">
          <h4 class="font-bold mb-2">Selected Item:</h4>
          <p><span class="font-semibold">Type:</span>
             {{ getNodeType(selectedNode) }}
          </p>
          <p><span class="font-semibold">Name:</span> {{ selectedNode.label }}</p>
          <p *ngIf="selectedNode.data?.id_sensor" class="font-semibold">
            Sensor ID: {{ selectedNode.data.id_sensor }}
          </p>
        </div>

        <button 
          pButton 
          type="submit" 
          label="Valider" 
          class="mt-3 w-full md:w-auto"
          [disabled]="!selectedNode"
        ></button>
      </form>
    </ng-template>
  </p-card>
</div>